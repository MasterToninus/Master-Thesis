(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     85642,       2562]
NotebookOptionsPosition[     80000,       2380]
NotebookOutlinePosition[     80778,       2405]
CellTagsIndexPosition[     80735,       2402]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Curvature and the Einstein Equation", "Subtitle"],

Cell[TextData[{
 "This is the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook ",
 StyleBox["Curvature and the Einstein Equation ",
  FontSlant->"Italic"],
 StyleBox["available from the book website.  F",
  FontVariations->{"CompatibilityType"->0}],
 "rom a given metric ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["g",
     FontSlant->"Italic"], "\[Alpha]\[Beta]"], TraditionalForm]]],
 " , it computes the components of the following: the inverse metric, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Lambda]\[Sigma]"], TraditionalForm]]],
 ", the Christoffel symbols or affine connection,"
}], "Text",
 CellChangeTimes->{{3.6511421143000293`*^9, 3.651142148711097*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Nu]"], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SuperscriptBox["g", "\[Lambda]\[Sigma]"], "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Nu]"]}], "+", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], " ", 
        SubscriptBox["g", "\[Sigma]\[Mu]"]}], "-", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Sigma]"], " ", 
        SubscriptBox["g", "\[Mu]\[Nu]"]}]}], ")"}]}]}], TraditionalForm]]],
 ", "
}], "Text",
 CellChangeTimes->{{3.651142238224518*^9, 3.651142259384342*^9}}],

Cell[TextData[{
 " ( ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"\[Alpha]", "  "}]], TraditionalForm]]],
 "stands for the partial derivative ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[PartialD]", 
    RowBox[{"/", 
     RowBox[{"\[PartialD]", 
      SuperscriptBox["x", "\[Alpha]"]}]}]}], TraditionalForm]]],
 "), the Riemann tensor,"
}], "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], " ", 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Sigma]"]}], 
     "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Sigma]"], " ", 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Mu]\[Nu]"]}], "+", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Eta]"], "\[Mu]\[Sigma]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], "\[Eta]\[Nu]"]}], "-", 
     
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Eta]"], "\[Mu]\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Lambda]"], 
       "\[Eta]\[Sigma]"]}]}]}], TraditionalForm]]],
 ","
}], "Text"],

Cell["the Ricci tensor", "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "\[Mu]\[Nu]"], "=", 
    SubscriptBox[
     SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Lambda]\[Nu]"]}], 
   TraditionalForm]]],
 ","
}], "Text"],

Cell["the scalar curvature,", "Text"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "=", 
    RowBox[{
     SuperscriptBox["g", "\[Mu]\[Nu]"], 
     SubscriptBox["R", "\[Mu]\[Nu]"]}]}], TraditionalForm]]],
 ","
}], "Text"],

Cell["and the Einstein tensor,", "Text"],

Cell[TextData[{
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Mu]\[Nu]"], "=", 
    RowBox[{
     SubscriptBox["R", "\[Mu]\[Nu]"], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SubscriptBox["g", "\[Mu]\[Nu]"], "R"}]}]}], TraditionalForm]]],
 "."
}], "Text"],

Cell[TextData[{
 "You must input the covariant components of the metric tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]]],
 " by editing the relevant input line in this ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook. You may also wish to change the names of the coordinates. Only \
the nonzero components of the above quantities are displayed as the output. \
All the components computed are in the ",
 StyleBox["coordinate basis ",
  FontSlant->"Italic"],
 StyleBox["in which the metric was specified. ",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"],

Cell[CellGroupData[{

Cell["Clearing the values of symbols:", "Subsubsection"],

Cell["\<\
First clear any values that may already have been assigned to the names of \
the various objects to be calculated. The names of the coordinates that you \
will use are also cleared.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "coord", ",", " ", "metric", ",", "inversemetric", ",", " ", "affine", ",", 
   " ", "riemann", ",", " ", "ricci", ",", " ", "scalar", ",", " ", 
   "einstein", ",", "r", ",", "\[Theta]", ",", "\[Phi]", ",", "t"}], 
  "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setting the dimension:", "Subsubsection"],

Cell[TextData[{
 "The dimension ",
 StyleBox["n ",
  FontWeight->"Bold"],
 StyleBox["of the spacetime (or space) must be set:",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "4"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.651142344240508*^9, 3.6511423547118587`*^9}, 
   3.651142496585789*^9, 3.651142538825802*^9, 3.6511431693355737`*^9, 
   3.6511437790113416`*^9, 3.651144509605465*^9, {3.651144617617792*^9, 
   3.651144654892166*^9}, 3.651144881635727*^9, 3.6511450279652667`*^9, 
   3.6511450922752047`*^9, {3.6511471249870634`*^9, 3.6511471533772182`*^9}, {
   3.6511472223477592`*^9, 3.6511472419065266`*^9}, 3.651147280699937*^9, {
   3.651147311200698*^9, 3.6511474068483815`*^9}, {3.6511474603715496`*^9, 
   3.6511475089141026`*^9}, {3.651147569684724*^9, 3.651147601302519*^9}, 
   3.6511478227857475`*^9, {3.6511480609651575`*^9, 3.6511480873716717`*^9}, 
   3.651148910385626*^9, 3.6511490220012283`*^9, 3.651150734293456*^9, 
   3.6511519907686205`*^9, 3.651152119334894*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining a list of coordinates:", "Subsubsection"],

Cell["\<\
The example given here is the Schwarzschild metric. The coordinate choice of \
Schwarzschild is appropriate for this spherically symmetric spacetime. \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"coord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.651142489076503*^9, 3.651142495007703*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6511423547118587`*^9, 3.6511424966014147`*^9, 3.651142538841407*^9, 
   3.651143169351218*^9, 3.651143779026946*^9, 3.651144509621109*^9, {
   3.651144617617792*^9, 3.6511446549077873`*^9}, 3.651144881651369*^9, 
   3.6511450279652667`*^9, 3.6511450922752047`*^9, {3.6511471250036936`*^9, 
   3.6511471533928633`*^9}, {3.6511472223557606`*^9, 3.651147241914527*^9}, 
   3.65114728071554*^9, {3.651147311200698*^9, 3.651147406863986*^9}, {
   3.6511474603871737`*^9, 3.6511475089297256`*^9}, {3.651147569684724*^9, 
   3.651147601302519*^9}, 3.6511478228013563`*^9, {3.6511480609807997`*^9, 
   3.6511480873716717`*^9}, 3.651148910416874*^9, 3.6511490220481052`*^9, 
   3.651150734293456*^9, 3.6511519907842455`*^9, 3.6511521193505*^9}]
}, Open  ]],

Cell[TextData[{
 "You can change the names of the coordinates by simply editing the \
definition of ",
 StyleBox["coord",
  FontWeight->"Bold"],
 ", for example, to ",
 StyleBox["coord = {x, y, z, t}",
  FontWeight->"Bold"],
 ", when another set of coordinate names is more appropriate. In this program \
indices range over ",
 StyleBox["1 ",
  FontWeight->"Bold"],
 StyleBox["to ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["n.  ",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["Thus for spacetime they range from 1 to 4 and ",
  FontVariations->{"CompatibilityType"->0}],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "4"], TraditionalForm]]],
 " is the same as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "0"], TraditionalForm]]],
 " used in the text. "
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining the metric:", "Subsubsection"],

Cell["\<\
Input the metric as a list of lists, i.e., as a matrix. You can input the \
components of any metric here, but you must specify them as explicit \
functions of the coordinates.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "^", "2"}]}], " ", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Chi]", " ", 
          RowBox[{"r", "^", "2"}]}]}], ")"}]}], ",", "0", ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "^", "2"}]}], 
       RowBox[{"(", 
        RowBox[{"r", "^", "2"}], ")"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], "^", "2"}]}], " ", 
       RowBox[{"r", "^", "2"}], " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{3.6511423411296883`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]}], ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.651142344271758*^9, 3.651142354742973*^9}, 
   3.6511424966170397`*^9, 3.651142538841407*^9, 3.651143169351218*^9, 
   3.651143779042591*^9, 3.65114450963672*^9, {3.651144617633398*^9, 
   3.6511446549077873`*^9}, 3.6511448816669955`*^9, 3.6511450279808936`*^9, 
   3.6511450922908373`*^9, {3.6511471250132055`*^9, 3.6511471533928633`*^9}, {
   3.6511472223677654`*^9, 3.6511472419225264`*^9}, 3.651147280731184*^9, {
   3.6511473112163057`*^9, 3.651147406863986*^9}, {3.6511474603871737`*^9, 
   3.651147508944212*^9}, {3.651147569700348*^9, 3.651147601318144*^9}, 
   3.6511478228013563`*^9, {3.6511480609807997`*^9, 3.6511480873872795`*^9}, 
   3.651148910432501*^9, 3.6511490220781307`*^9, 3.6511507343090835`*^9, 
   3.6511519907842455`*^9, 3.6511521193505*^9}]
}, Open  ]],

Cell["You can also display this in matrix form.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["r", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["r", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.651142344271758*^9, 3.651142354751996*^9}, 
   3.6511425388570323`*^9, 3.651143169366824*^9, 3.651143779042591*^9, 
   3.65114450963672*^9, {3.651144617633398*^9, 3.6511446549234123`*^9}, 
   3.6511448816669955`*^9, 3.6511450279965367`*^9, 3.6511450922908373`*^9, {
   3.6511471250237217`*^9, 3.6511471534084883`*^9}, {3.651147222375762*^9, 
   3.65114724193053*^9}, 3.651147280731184*^9, {3.6511473112163057`*^9, 
   3.651147406879628*^9}, {3.651147460402817*^9, 3.651147508955702*^9}, {
   3.651147569715975*^9, 3.651147601333767*^9}, 3.651147822816998*^9, {
   3.6511480609964075`*^9, 3.6511480874029055`*^9}, 3.6511489104481244`*^9, 
   3.651149022097646*^9, 3.6511507343090835`*^9, 3.651151990799879*^9, 
   3.6511521193661427`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Note:", "Subsubsection"],

Cell[TextData[{
 "It is important not to use the symbols, ",
 StyleBox["i",
  FontWeight->"Bold"],
 ", ",
 StyleBox["j",
  FontWeight->"Bold"],
 ", ",
 StyleBox["k",
  FontWeight->"Bold"],
 ", ",
 StyleBox["l,",
  FontWeight->"Bold"],
 StyleBox[" ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["s, ",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["or ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox["n",
  FontWeight->"Bold",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox[" ",
  FontWeight->"Bold"],
 "as constants or coordinates in the metric that you specify above. The \
reason is that the first five of  those symbols are used as summation or \
table indices in the calculations done below, and ",
 StyleBox["n ",
  FontWeight->"Bold"],
 StyleBox["is the dimension of the space. ",
  FontVariations->{"CompatibilityType"->0}],
 "For example, if ",
 StyleBox["m",
  FontWeight->"Bold"],
 " were used as a summation or table index below, then you would get the \
wrong answer for the present metric because the ",
 StyleBox["m",
  FontWeight->"Bold"],
 " in the metric would be treated as an index, rather than as the mass."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the inverse metric:", "Subsubsection"],

Cell["The inverse metric is obtained through matrix inversion.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inversemetric", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Inverse", "[", "metric", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]], ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.651142344287383*^9, 3.6511423547650056`*^9}, 
   3.651142538872655*^9, 3.651143169382468*^9, 3.6511437790582004`*^9, 
   3.651144509652343*^9, {3.6511446176490335`*^9, 3.6511446549390388`*^9}, 
   3.651144881682603*^9, 3.6511450279965367`*^9, 3.6511450923064556`*^9, {
   3.6511471250347233`*^9, 3.6511471534084883`*^9}, {3.651147222387763*^9, 
   3.6511472419425116`*^9}, 3.65114728074679*^9, {3.6511473112319345`*^9, 
   3.6511474068975725`*^9}, {3.6511474604184427`*^9, 3.65114750896721*^9}, {
   3.651147569715975*^9, 3.6511476013493958`*^9}, 3.6511478228326073`*^9, {
   3.6511480610120363`*^9, 3.6511480874029055`*^9}, 3.6511489104850564`*^9, 
   3.6511490221191597`*^9, 3.651150734324707*^9, 3.651151990815494*^9, 
   3.6511521193817673`*^9}]
}, Open  ]],

Cell["This can also be displayed in matrix form:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inversemetric", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]}]]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.651142344303009*^9, 3.651142354775996*^9}, 
   3.651142538872655*^9, 3.651143169398094*^9, 3.651143779073826*^9, 
   3.651144509652343*^9, {3.6511446176646485`*^9, 3.6511446549390388`*^9}, 
   3.651144881682603*^9, 3.651145028012143*^9, 3.6511450923263226`*^9, {
   3.651147125045243*^9, 3.6511471534241047`*^9}, {3.6511472223997817`*^9, 
   3.6511472419545116`*^9}, 3.651147280762416*^9, {3.651147311247554*^9, 
   3.6511474069080973`*^9}, {3.6511474604184427`*^9, 
   3.6511475089797187`*^9}, {3.651147569731612*^9, 3.6511476013493958`*^9}, 
   3.6511478228326073`*^9, {3.651148061027661*^9, 3.6511480874185295`*^9}, 
   3.6511489104975615`*^9, 3.6511490221371937`*^9, 3.6511507343459744`*^9, 
   3.651151990815494*^9, 3.6511521193817673`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the Christoffel symbols:", "Subsubsection"],

Cell[TextData[{
 "The calculation of the components of the Christoffel symbols is done by \
transcribing the definition given earlier into the notation of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and using the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " functions ",
 StyleBox["D",
  FontWeight->"Bold"],
 " for taking partial derivatives, ",
 StyleBox["Sum",
  FontWeight->"Bold"],
 " for summing over repeated indices, ",
 StyleBox["Table",
  FontWeight->"Bold"],
 " for forming a list of components, and ",
 StyleBox["Simplify",
  FontWeight->"Bold"],
 " for simplifying the result."
}], "Text"],

Cell[BoxData[
 RowBox[{"affine", ":=", 
  RowBox[{"affine", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"inversemetric", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "+", 
            "\[IndentingNewLine]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coord", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], " ", "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying the Christoffel symbols:", "Subsubsection"],

Cell[TextData[{
 "The nonzero Christoffel symbols are displayed below. You need not follow \
the details of constructing the functions that we use for that purpose.  In \
the output the symbol \[CapitalGamma][1,2,3] stands for",
 StyleBox[" ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "1"], "23"], TraditionalForm]]],
 ". Because the Christoffel symbols are symmetric under interchange of the \
last two indices, only the independent components are displayed."
}], "Text"],

Cell[BoxData[
 RowBox[{"listaffine", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", "0"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"\[CapitalGamma]", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}], 
    " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listaffine", "]"}], ",", "Null"}], "]"}], ",",
      "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\[CapitalGamma][1, 2, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"\[CapitalGamma][1, 3, 3]\"\>", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]},
    {"\<\"\[CapitalGamma][1, 4, 4]\"\>", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]},
    {"\<\"\[CapitalGamma][2, 2, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"a", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][2, 2, 2]\"\>", 
     FractionBox[
      RowBox[{"r", " ", "\[Chi]"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"\[CapitalGamma][2, 3, 3]\"\>", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], ")"}]}]},
    {"\<\"\[CapitalGamma][2, 4, 4]\"\>", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]},
    {"\<\"\[CapitalGamma][3, 3, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"a", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][3, 3, 2]\"\>", 
     FractionBox["1", "r"]},
    {"\<\"\[CapitalGamma][3, 4, 4]\"\>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
    {"\<\"\[CapitalGamma][4, 4, 1]\"\>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], 
      RowBox[{"a", "[", "t", "]"}]]},
    {"\<\"\[CapitalGamma][4, 4, 2]\"\>", 
     FractionBox["1", "r"]},
    {"\<\"\[CapitalGamma][4, 4, 3]\"\>", 
     RowBox[{"Cot", "[", "\[Theta]", "]"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{{3.651142344349903*^9, 3.651142354820423*^9}, 
   3.651142538919531*^9, 3.651143169429327*^9, 3.6511437791050735`*^9, 
   3.6511445096836042`*^9, {3.6511446176959*^9, 3.651144654985897*^9}, 
   3.651144881713852*^9, 3.651145028043395*^9, 3.6511450923545256`*^9, {
   3.6511471250822573`*^9, 3.6511471534709835`*^9}, {3.651147222439782*^9, 
   3.6511472419905157`*^9}, 3.6511472807936687`*^9, {3.651147311278805*^9, 
   3.6511474069426227`*^9}, {3.6511474604496737`*^9, 
   3.6511475090142612`*^9}, {3.651147569762849*^9, 3.6511476013806453`*^9}, 
   3.651147822863861*^9, {3.65114806106785*^9, 3.651148087465431*^9}, 
   3.6511489105486126`*^9, 3.6511490222017393`*^9, 3.6511507343849955`*^9, 
   3.6511519908467703`*^9, 3.6511521194129987`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating and displaying the Riemann tensor:", "Subsubsection"],

Cell[TextData[{
 "The components of the Riemann tensor, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], 
   TraditionalForm]]],
 ", are calculated using the definition given above."
}], "Text"],

Cell[BoxData[
 RowBox[{"riemann", ":=", 
  RowBox[{"riemann", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
         RowBox[{"coord", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
         RowBox[{"coord", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], " ", "]"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "k", ",", "s"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "l", ",", "s"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"],

Cell[TextData[{
 "The nonzero components are displayed by the following functions. In the \
output, the symbol R[1, 2, 1, 3] stands for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "1"], "213"], TraditionalForm]]],
 ", and similarly for the other components.",
 " You can obtain R[1, 2, 3, 1] from R[1, 2, 1, 3] using the antisymmetry of \
the Riemann tensor under exchange of the last two indices. The antisymmetry \
under exchange of the first two indices of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "\[Lambda]\[Mu]\[Nu]\[Sigma]"], TraditionalForm]]],
 " is not evident in the output because the components of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "\[Lambda]"], "\[Mu]\[Nu]\[Sigma]"], 
   TraditionalForm]]],
 " are displayed."
}], "Text"],

Cell[BoxData[
 RowBox[{"listriemann", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"R", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
       "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", 
      RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listriemann", "]"}], ",", "Null"}], "]"}], 
     ",", "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R[1, 2, 2, 1]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"R[1, 3, 3, 1]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]},
    {"\<\"R[1, 4, 4, 1]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]},
    {"\<\"R[2, 1, 2, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {"\<\"R[2, 3, 3, 2]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]},
    {"\<\"R[2, 4, 4, 2]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]},
    {"\<\"R[3, 1, 3, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {"\<\"R[3, 2, 3, 2]\"\>", 
     FractionBox[
      RowBox[{"\[Chi]", "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"R[3, 4, 4, 3]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]},
    {"\<\"R[4, 1, 4, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {"\<\"R[4, 2, 4, 2]\"\>", 
     FractionBox[
      RowBox[{"\[Chi]", "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"R[4, 3, 4, 3]\"\>", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{{3.651142345256164*^9, 3.6511423549855595`*^9}, 
   3.651142538950782*^9, 3.651143169476221*^9, 3.6511437791519485`*^9, 
   3.6511445097148438`*^9, {3.651144617742776*^9, 3.651144655017145*^9}, 
   3.651144881760727*^9, 3.651145028090272*^9, 3.651145092385771*^9, {
   3.6511471251248026`*^9, 3.6511471535022173`*^9}, {3.6511472224844065`*^9, 
   3.6511472420305357`*^9}, 3.6511472808249207`*^9, {3.6511473113100576`*^9, 
   3.6511474069816513`*^9}, {3.6511474604809256`*^9, 
   3.6511475090602937`*^9}, {3.6511475698097234`*^9, 3.651147601411893*^9}, 
   3.6511478229107337`*^9, {3.651148061112381*^9, 3.6511480874966583`*^9}, 
   3.6511489106191673`*^9, 3.6511490222759676`*^9, 3.6511507344295335`*^9, 
   3.65115199089364*^9, 3.6511521194598775`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating and displaying the Ricci tensor:", "Subsubsection"],

Cell[TextData[{
 "The Ricci tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "\[Mu]\[Nu]"], TraditionalForm]]],
 " was defined by summing the first and third indices of the Riemann tensor \
(which has the first index already raised)."
}], "Text"],

Cell[BoxData[
 RowBox[{"ricci", ":=", 
  RowBox[{"ricci", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"riemann", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
    "]"}]}]}]], "Input"],

Cell[TextData[{
 "Next we display the nonzero components. In the output, R[1, 2] denotes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "12"], TraditionalForm]]],
 ", and similarly for the other components."
}], "Text"],

Cell[BoxData[
 RowBox[{"listricci", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"ricci", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"R", "[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"ricci", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listricci", "]"}], ",", "Null"}], "]"}], ",", 
     "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"R[1, 1]\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {"\<\"R[2, 2]\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "\[Chi]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"R[3, 3]\"\>", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Chi]", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]},
    {"\<\"R[4, 4]\"\>", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Chi]", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{{3.651142345584277*^9, 3.6511423550290933`*^9}, 
   3.651142538982032*^9, 3.6511431695074515`*^9, 3.651143779183199*^9, 
   3.6511445097460938`*^9, {3.651144617774026*^9, 3.651144655032792*^9}, 
   3.6511448817919774`*^9, 3.651145028105895*^9, 3.6511450924170237`*^9, {
   3.6511471251523027`*^9, 3.651147153533469*^9}, {3.6511472225134277`*^9, 
   3.6511472420585375`*^9}, 3.651147280856168*^9, {3.651147311341305*^9, 
   3.6511474070121527`*^9}, {3.651147460512176*^9, 3.6511475090898094`*^9}, {
   3.6511475698475046`*^9, 3.651147601443143*^9}, 3.6511478229420033`*^9, {
   3.651148061147405*^9, 3.651148087527909*^9}, 3.6511489106547365`*^9, 
   3.6511490223228407`*^9, 3.6511507344580345`*^9, 3.651151990909248*^9, 
   3.651152119475499*^9}]
}, Open  ]],

Cell["\<\
A vanishing table (as with the Schwarzschild metric example)  means that the \
vacuum Einstein equation is satisfied.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the scalar curvature:", "Subsubsection"],

Cell[TextData[{
 "The scalar curvature ",
 StyleBox["R",
  FontSlant->"Italic"],
 " is calculated using the inverse metric and the Ricci tensor. The result is \
displayed in the output line."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalar", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"inversemetric", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], 
      RowBox[{"ricci", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"6", " ", 
    RowBox[{"(", 
     RowBox[{"\[Chi]", "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"a", "[", "t", "]"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.6511423457405295`*^9, 3.6511423550676146`*^9}, 
   3.651142538997657*^9, 3.6511431695230765`*^9, 3.6511437791988244`*^9, 
   3.6511445097617188`*^9, {3.651144617789651*^9, 3.651144655048401*^9}, 
   3.6511448817919774`*^9, 3.651145028121521*^9, 3.6511450924170237`*^9, {
   3.651147125165312*^9, 3.6511471535490956`*^9}, {3.6511472225289536`*^9, 
   3.6511472420705214`*^9}, 3.6511472808718023`*^9, {3.65114731135693*^9, 
   3.651147407026164*^9}, {3.65114746052781*^9, 3.6511475091053267`*^9}, {
   3.651147569864016*^9, 3.651147601458781*^9}, 3.6511478229576097`*^9, {
   3.6511480611629367`*^9, 3.6511480875435333`*^9}, 3.6511489106699376`*^9, 
   3.6511490223384657`*^9, 3.651150734473547*^9, 3.6511519909248705`*^9, 
   3.6511521194911237`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the Einstein tensor:", "Subsubsection"],

Cell[TextData[{
 "The Einstein tensor,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Mu]\[Nu]"], "=", 
    RowBox[{
     SubscriptBox["R", "\[Mu]\[Nu]"], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      SubscriptBox["g", "\[Mu]\[Nu]"], "R"}]}]}], TraditionalForm]]],
 ", is found from the tensors already calculated."
}], "Text"],

Cell[BoxData[
 RowBox[{"einstein", ":=", 
  RowBox[{"einstein", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ricci", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "scalar", "*", "metric"}]}], 
    "]"}]}]}]], "Input"],

Cell["\<\
The results are displayed in the same way as for the Ricci tensor earlier.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"listeinstein", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{"einstein", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"G", "[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"einstein", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "l"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", "j"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "listeinstein", "]"}], ",", "Null"}], "]"}], 
     ",", "2"}], "]"}], ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"G[1, 1]\"\>", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"\[Chi]", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]]},
    {"\<\"G[2, 2]\"\>", 
     FractionBox[
      RowBox[{"\[Chi]", "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {"\<\"G[3, 3]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
        RowBox[{"2", " ", 
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]},
    {"\<\"G[4, 4]\"\>", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Chi]", "+", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
        RowBox[{"2", " ", 
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["a", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[1.4]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2, 2}]]]], "Output",
 CellChangeTimes->{{3.651142346099907*^9, 3.6511423551036444`*^9}, 
   3.6511425390289135`*^9, 3.6511431695543327`*^9, 3.6511437792300744`*^9, 
   3.6511445097929707`*^9, {3.651144617820901*^9, 3.651144655079646*^9}, 
   3.651144881823229*^9, 3.651145028158284*^9, 3.651145092451556*^9, {
   3.65114712519083*^9, 3.651147153564723*^9}, {3.651147222555462*^9, 
   3.6511472420945234`*^9}, 3.651147280887422*^9, {3.6511473113882017`*^9, 
   3.6511474070501986`*^9}, {3.6511474605590525`*^9, 3.651147509129343*^9}, {
   3.6511475698915186`*^9, 3.6511476014900217`*^9}, 3.6511478229732533`*^9, {
   3.6511480611939383`*^9, 3.651148087574786*^9}, 3.6511489107019587`*^9, 
   3.6511490223540936`*^9, 3.651150734498063*^9, 3.651151990956121*^9, 
   3.651152119522378*^9}]
}, Open  ]],

Cell["\<\
A vanishing table means that the vacuum Einstein equation is satisfied!\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the geodesic equations:", "Subsubsection"],

Cell[TextData[{
 "The geodesic equations are calculated by asking  ",
 StyleBox["Mathematica ",
  FontSlant->"Italic"],
 StyleBox["to carry out the sum -",
  FontVariations->{"CompatibilityType"->0}],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Beta]\[Gamma]"], 
   TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Beta]"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Gamma]"], TraditionalForm]]],
 ",  where ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Alpha]"], TraditionalForm]]],
 " are the components of the four-velocity.  (This gives the derivitive of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "\[Alpha]"], TraditionalForm]]],
 " with respect to proper time  \[Tau].  (This is replaced by  ",
 StyleBox["s",
  FontSlant->"Italic"],
 "  if the geodesics are spacelike.)"
}], "Text"],

Cell[BoxData[
 RowBox[{"geodesic", ":=", 
  RowBox[{"geodesic", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
          RowBox[{"u", "[", "j", "]"}], 
          RowBox[{"u", "[", "k", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying the geodesic equations:", "Subsubsection"],

Cell[BoxData[
 RowBox[{"listgeodesic", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<d/d\[Tau]\>\"", 
       RowBox[{"ToString", "[", 
        RowBox[{"u", "[", "i", "]"}], "]"}]}], ",", "\"\<=\>\"", ",", 
      RowBox[{"geodesic", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"listgeodesic", ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", "2", "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\<\"d/d\[Tau]\"\>", " ", "\<\"u[1]\"\>"}], "\<\"=\"\>", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"u", "[", "2", "]"}], "2"], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]], "-", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "3", "]"}], "2"]}], "-", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"u", "[", "4", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]},
    {
     RowBox[{"\<\"d/d\[Tau]\"\>", " ", "\<\"u[2]\"\>"}], "\<\"=\"\>", 
     RowBox[{
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Chi]", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "2", "]"}], "2"]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]], "+", 
         SuperscriptBox[
          RowBox[{"u", "[", "3", "]"}], "2"], "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Chi]", " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "3", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"u", "[", "4", "]"}], "2"]}]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"u", "[", "1", "]"}], " ", 
        RowBox[{"u", "[", "2", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {
     RowBox[{"\<\"d/d\[Tau]\"\>", " ", "\<\"u[3]\"\>"}], "\<\"=\"\>", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "3", "]"}]}], "r"]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"u", "[", "4", "]"}], "2"]}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"u", "[", "1", "]"}], " ", 
        RowBox[{"u", "[", "3", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {
     RowBox[{"\<\"d/d\[Tau]\"\>", " ", "\<\"u[4]\"\>"}], "\<\"=\"\>", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"u", "[", "4", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u", "[", "2", "]"}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"u", "[", "3", "]"}]}]}], ")"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"u", "[", "1", "]"}], " ", 
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
       RowBox[{"r", " ", 
        RowBox[{"a", "[", "t", "]"}]}]]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2}]]]], "Output",
 CellChangeTimes->{
  3.6511412239621086`*^9, 3.6511414265398464`*^9, 3.6511417080442696`*^9, {
   3.651141745907316*^9, 3.651141759983848*^9}, 3.651141925502562*^9, 
   3.651141969980076*^9, 3.651143169648096*^9, 3.6511437792613254`*^9, 
   3.651144509824219*^9, {3.6511446178365283`*^9, 3.651144655095273*^9}, 
   3.651144881854493*^9, 3.6511450281812983`*^9, 3.6511450924755554`*^9, {
   3.6511471253099184`*^9, 3.651147153580364*^9}, {3.651147222579982*^9, 
   3.651147242114525*^9}, 3.651147280918668*^9, {3.6511473114038258`*^9, 
   3.6511474073472786`*^9}, {3.651147460855933*^9, 3.651147509673216*^9}, {
   3.6511475701926284`*^9, 3.65114760178692*^9}, 3.651147823286955*^9, {
   3.6511480615218244`*^9, 3.651148087902915*^9}, {3.6511481621848516`*^9, 
   3.6511481645268545`*^9}, 3.651148911414192*^9, 3.651149022385341*^9, 
   3.6511507345316057`*^9, 3.6511519909717464`*^9, 3.6511521195380025`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating the Jacobi equations:", "Subsubsection",
 CellChangeTimes->{{3.651142697123042*^9, 3.6511426989378653`*^9}}],

Cell[TextData[{
 "The Jacobi equations are \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["Y", "\[Prime]\[Prime]"], ")"}], "\[Mu]"], "+", 
     RowBox[{
      SubsuperscriptBox[
       StyleBox["R", "TI"], 
       RowBox[{
        StyleBox["i", "TI"], "\[Alpha]", "\[DotlessJ]"}], "\[Mu]"], 
      SuperscriptBox["u", 
       StyleBox["i", "TI"]], 
      SuperscriptBox[
       StyleBox["X", "TI"], "\[Alpha]"], 
      SuperscriptBox[
       StyleBox["u", "TI"], 
       StyleBox["j", "TI"]]}]}], "\[LongEqual]", "0"}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{
  3.6511427112003355`*^9, {3.6511432869962645`*^9, 3.6511433170366683`*^9}, 
   3.651143379974839*^9, 3.651143854637783*^9, {3.651143888532942*^9, 
   3.6511439218411636`*^9}, {3.651144170114196*^9, 3.651144174230474*^9}, {
   3.6511442107245703`*^9, 3.6511442113651996`*^9}, {3.6511460821956863`*^9, 
   3.651146101392825*^9}, 3.6511461509560986`*^9, {3.651150306274652*^9, 
   3.651150313852889*^9}}],

Cell["The right term of Jacobi equation is\t\t\t", "Text",
 CellChangeTimes->{
  3.6511427112003355`*^9, {3.6511432869962645`*^9, 3.6511433170366683`*^9}, 
   3.651143379974839*^9, 3.651143854637783*^9, {3.651143888532942*^9, 
   3.6511439218411636`*^9}, {3.651144170114196*^9, 3.651144174230474*^9}, {
   3.6511442153649817`*^9, 3.651144218921136*^9}, {3.6511489422096467`*^9, 
   3.651149018610613*^9}, {3.6511490925515766`*^9, 3.6511490925515766`*^9}, {
   3.651150311321602*^9, 3.651150335775095*^9}}],

Cell[BoxData[
 RowBox[{"jacobi1", ":=", "\[IndentingNewLine]", 
  RowBox[{"jacobi1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"riemann", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
          RowBox[{"u", "[", "j", "]"}], 
          RowBox[{"Y", "[", "k", "]"}], 
          RowBox[{"u", "[", "l", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "n"}], " ", "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6511439473977766`*^9, 3.6511439626851387`*^9}, 
   3.651144069420865*^9, {3.6511444396948185`*^9, 3.6511444633910303`*^9}, {
   3.6511445053427587`*^9, 3.6511445079221687`*^9}, {3.6511449339313545`*^9, 
   3.6511449981548347`*^9}, {3.6511450772697334`*^9, 3.651145090868991*^9}, {
   3.6511489509431505`*^9, 3.6511489513337235`*^9}, {3.6511507103087854`*^9, 
   3.6511507200433073`*^9}, 3.651151115166421*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying the first term in Jacobi equations:", "Subsubsection",
 CellChangeTimes->{{3.6511445386337695`*^9, 3.651144539670128*^9}, {
  3.65115034832215*^9, 3.651150351572199*^9}}],

Cell[BoxData[
 RowBox[{"listJacobi1", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<D/dt^2\>\"", 
       RowBox[{"ToString", "[", 
        RowBox[{"Y", "[", "i", "]"}], "]"}]}], ",", "\"\<=\>\"", ",", 
      RowBox[{"jacobi1", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6511445430584693`*^9, 3.651144572762887*^9}, {
   3.6511446151646147`*^9, 3.6511446160396843`*^9}, 3.6511507324496803`*^9, 
   3.651151826641207*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"listJacobi", ",", 
   RowBox[{"TableSpacing", "\[Rule]", 
    RowBox[{"{", "2", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65114465215039*^9, 3.651144653876568*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"\<\"D/dt^2\"\>", " ", "\<\"Y[1]\"\>"}], "\<\"=\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"u", "[", "2", "]"}], "2"], " ", 
          RowBox[{"Y", "[", "1", "]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "[", "1", "]"}], " ", 
          RowBox[{"u", "[", "2", "]"}], " ", 
          RowBox[{"Y", "[", "2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], ")"}], " ", 
          RowBox[{"u", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "3", "]"}], " ", 
             RowBox[{"Y", "[", "1", "]"}]}], "-", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], " ", 
             RowBox[{"Y", "[", "3", "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", "\[Chi]"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
          RowBox[{"u", "[", "4", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "4", "]"}], " ", 
             RowBox[{"Y", "[", "1", "]"}]}], "-", 
            RowBox[{
             RowBox[{"u", "[", "1", "]"}], " ", 
             RowBox[{"Y", "[", "4", "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]},
    {
     RowBox[{"\<\"D/dt^2\"\>", " ", "\<\"Y[2]\"\>"}], "\<\"=\"\>", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"u", "[", "3", "]"}], "2"], " ", 
           RowBox[{"Y", "[", "2", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"u", "[", "2", "]"}], " ", 
           RowBox[{"u", "[", "3", "]"}], " ", 
           RowBox[{"Y", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"u", "[", "4", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], " ", 
              RowBox[{"Y", "[", "2", "]"}]}], "-", 
             RowBox[{
              RowBox[{"u", "[", "2", "]"}], " ", 
              RowBox[{"Y", "[", "4", "]"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
           RowBox[{"u", "[", "4", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", "4", "]"}], " ", 
              RowBox[{"Y", "[", "2", "]"}]}], "-", 
             RowBox[{
              RowBox[{"u", "[", "2", "]"}], " ", 
              RowBox[{"Y", "[", "4", "]"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Chi]", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
       
       RowBox[{
        RowBox[{"u", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"u", "[", "2", "]"}]}], " ", 
           RowBox[{"Y", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"u", "[", "1", "]"}], " ", 
           RowBox[{"Y", "[", "2", "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{"a", "[", "t", "]"}]]},
    {
     RowBox[{"\<\"D/dt^2\"\>", " ", "\<\"Y[3]\"\>"}], "\<\"=\"\>", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "3", "]"}], " ", 
         RowBox[{"Y", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Chi]", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", "2", "]"}], "2"], " ", 
        RowBox[{"Y", "[", "3", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Chi]", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]], "-", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"u", "[", "4", "]"}], "2"], " ", 
       RowBox[{"Y", "[", "3", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Chi]", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"u", "[", "3", "]"}], " ", 
       RowBox[{"u", "[", "4", "]"}], " ", 
       RowBox[{"Y", "[", "4", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Chi]", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"u", "[", "1", "]"}], " ", 
        RowBox[{"u", "[", "3", "]"}], " ", 
        RowBox[{"Y", "[", "1", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", "1", "]"}], "2"], " ", 
        RowBox[{"Y", "[", "3", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]]}]},
    {
     RowBox[{"\<\"D/dt^2\"\>", " ", "\<\"Y[4]\"\>"}], "\<\"=\"\>", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"u", "[", "2", "]"}], " ", 
         RowBox[{"u", "[", "4", "]"}], " ", 
         RowBox[{"Y", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Chi]", "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"u", "[", "3", "]"}], " ", 
       RowBox[{"u", "[", "4", "]"}], " ", 
       RowBox[{"Y", "[", "3", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Chi]", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", "2", "]"}], "2"], " ", 
        RowBox[{"Y", "[", "4", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Chi]", "+", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", "\[Chi]"}]}]], "-", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"u", "[", "3", "]"}], "2"], " ", 
       RowBox[{"Y", "[", "4", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Chi]", "+", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["a", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"u", "[", "1", "]"}], " ", 
        RowBox[{"u", "[", "4", "]"}], " ", 
        RowBox[{"Y", "[", "1", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", "1", "]"}], "2"], " ", 
        RowBox[{"Y", "[", "4", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"a", "[", "t", "]"}]]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.8]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableSpacing -> {2}]]]], "Output",
 CellChangeTimes->{
  3.6511412239621086`*^9, 3.6511414265398464`*^9, 3.6511417080442696`*^9, {
   3.651141745907316*^9, 3.651141759983848*^9}, 3.651141925502562*^9, 
   3.651141969980076*^9, 3.651143169648096*^9, 3.6511437792613254`*^9, 
   3.651144509824219*^9, {3.6511446178677783`*^9, 3.6511446558609066`*^9}, 
   3.651144881901355*^9, 3.651145029322548*^9, 3.651145093597045*^9, {
   3.6511471254710608`*^9, 3.651147153689741*^9}, {3.6511472226885586`*^9, 
   3.651147242218548*^9}, 3.6511472810124197`*^9, {3.6511473114975586`*^9, 
   3.651147407956663*^9}, {3.6511474614496884`*^9, 3.6511475103785744`*^9}, {
   3.6511475708176193`*^9, 3.6511476023338003`*^9}, 3.6511478238338366`*^9, {
   3.6511480620843115`*^9, 3.6511480883259153`*^9}, 3.651148912733321*^9, 
   3.651149022433114*^9, 3.651150734605651*^9, 3.6511519910030003`*^9, 
   3.651152119569251*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6511459706870403`*^9, 3.6511459716558537`*^9}, {
  3.651151540006421*^9, 3.6511515414908457`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Esplicitare Y\[CloseCurlyQuote]\[CloseCurlyQuote]= D/dt^2 Y", \
"Subsubsection",
 CellChangeTimes->{{3.651142697123042*^9, 3.6511426989378653`*^9}, {
  3.6511503748203545`*^9, 3.651150380117305*^9}, {3.6511525093610487`*^9, 
  3.6511525167202764`*^9}}],

Cell[TextData[{
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      StyleBox[
       RowBox[{"X", "''"}], "TI"], ")"}], "\[Mu]"], "=", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox[
       StyleBox["X", "TI"], "\[DoubleDot]"], "\[Mu]"], "+", 
     RowBox[{"2", 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SuperscriptBox[
       OverscriptBox[
        StyleBox["X", "TI"], "."], "\[Nu]"]}], "+", 
     RowBox[{
      SubsuperscriptBox[
       OverscriptBox[
        StyleBox["\[CapitalGamma]", "TI"], "."], 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SuperscriptBox[
       StyleBox["X", "TI"], "\[Nu]"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       OverscriptBox[
        StyleBox["T", "TI"], "."], "j"], 
      SuperscriptBox[
       StyleBox["X", "TI"], 
       StyleBox["\[Nu]", "TI"]]}], "+", 
     RowBox[{
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["i", "TI"], "\[Alpha]"}]}], "\[Nu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["i", "TI"]], 
      SuperscriptBox[
       StyleBox["X", "TI"], "\[Alpha]"]}]}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     OverscriptBox[
      StyleBox["X", "TI"], "\[DoubleDot]"], "\[Mu]"], " ", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       StyleBox[
        RowBox[{"X", "''"}], "TI"], ")"}], "\[Mu]"], "-", 
     RowBox[{"2", 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SuperscriptBox[
       OverscriptBox[
        StyleBox["X", "TI"], "."], "\[Nu]"]}], "-", 
     RowBox[{
      SubsuperscriptBox[
       OverscriptBox[
        StyleBox["\[CapitalGamma]", "TI"], "."], 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SuperscriptBox[
       StyleBox["X", "TI"], "\[Nu]"]}], "-", 
     RowBox[{
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SuperscriptBox[
       OverscriptBox[
        StyleBox["T", "TI"], "."], "j"], 
      SuperscriptBox[
       StyleBox["X", "TI"], 
       StyleBox["\[Nu]", "TI"]]}], "-", 
     RowBox[{
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["j", "TI"]], 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["j", "TI"], "\[Nu]"}]}], "\[Mu]"], 
      SubsuperscriptBox["\[CapitalGamma]", 
       RowBox[{" ", 
        RowBox[{
         StyleBox["i", "TI"], "\[Alpha]"}]}], "\[Nu]"], 
      SuperscriptBox[
       StyleBox["T", "TI"], 
       StyleBox["i", "TI"]], 
      SuperscriptBox[
       StyleBox["X", "TI"], "\[Alpha]"]}]}]}], TraditionalForm]]],
 "\n"
}], "Text",
 CellChangeTimes->{
  3.6511427112003355`*^9, {3.6511432869962645`*^9, 3.6511433170366683`*^9}, 
   3.651143379974839*^9, 3.651143854637783*^9, {3.651143888532942*^9, 
   3.6511439218411636`*^9}, {3.651144170114196*^9, 3.651144174230474*^9}, {
   3.6511442107245703`*^9, 3.6511442113651996`*^9}, {3.6511460821956863`*^9, 
   3.651146101392825*^9}, 3.6511461509560986`*^9, {3.651150306274652*^9, 
   3.651150313852889*^9}, {3.6511504986301565`*^9, 3.651150693946499*^9}, 
   3.6511508411770945`*^9, {3.6511515456471586`*^9, 3.6511515456471586`*^9}, {
   3.651151646490576*^9, 3.651151647162406*^9}, {3.651151755018427*^9, 
   3.651151790954797*^9}}],

Cell[BoxData[
 RowBox[{"termA", ":=", "\[IndentingNewLine]", 
  RowBox[{"termA", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"affine", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
          RowBox[{"u", "[", "j", "]"}], 
          RowBox[{
           RowBox[{"Y", "'"}], "[", "k", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6511439473977766`*^9, 3.6511439626851387`*^9}, 
   3.651144069420865*^9, {3.6511444396948185`*^9, 3.6511444633910303`*^9}, {
   3.6511445053427587`*^9, 3.6511445079221687`*^9}, {3.6511449339313545`*^9, 
   3.6511449981548347`*^9}, {3.6511450772697334`*^9, 3.651145090868991*^9}, {
   3.6511489509431505`*^9, 3.6511489513337235`*^9}, {3.6511507103087854`*^9, 
   3.6511507200433073`*^9}, 3.651151115166421*^9, {3.6511516786716003`*^9, 
   3.6511517445196047`*^9}, {3.6511518078786955`*^9, 3.651151841498323*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acknowledgment", "Subsubsection"],

Cell[TextData[{
 "This program was kindly written by ",
 StyleBox["Leonard Parker, University of Wisconsin, Milwaukee ",
  FontSlant->"Italic"],
 StyleBox["especially ",
  FontVariations->{"CompatibilityType"->0}],
 StyleBox[" ",
  FontSlant->"Italic"],
 StyleBox["for this text. ",
  FontVariations->{"CompatibilityType"->0}]
}], "Text"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1080, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PostScriptOutputFile":>FrontEnd`FileName[{$RootDirectory, "home", "hartle", 
   "131book", "math", "Curvature"}, "curvature-n.ps1", CharacterEncoding -> 
  "ISO8859-1"]},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification->1.5,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 55, 0, 84, "Subtitle"],
Cell[638, 24, 711, 21, 107, "Text"],
Cell[1352, 47, 741, 22, 56, "Text"],
Cell[2096, 71, 376, 14, 45, "Text"],
Cell[2475, 87, 945, 29, 50, "Text"],
Cell[3423, 118, 32, 0, 45, "Text"],
Cell[3458, 120, 220, 9, 50, "Text"],
Cell[3681, 131, 37, 0, 45, "Text"],
Cell[3721, 133, 196, 8, 48, "Text"],
Cell[3920, 143, 40, 0, 45, "Text"],
Cell[3963, 145, 290, 12, 56, "Text"],
Cell[4256, 159, 619, 15, 134, "Text"],
Cell[CellGroupData[{
Cell[4900, 178, 56, 0, 58, "Subsubsection"],
Cell[4959, 180, 205, 4, 74, "Text"],
Cell[5167, 186, 285, 6, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5489, 197, 47, 0, 58, "Subsubsection"],
Cell[5539, 199, 183, 6, 45, "Text"],
Cell[CellGroupData[{
Cell[5747, 209, 49, 1, 45, "Input"],
Cell[5799, 212, 820, 11, 44, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6668, 229, 56, 0, 58, "Subsubsection"],
Cell[6727, 231, 174, 3, 74, "Text"],
Cell[CellGroupData[{
Cell[6926, 238, 245, 6, 45, "Input"],
Cell[7174, 246, 865, 13, 44, "Output"]
}, Open  ]],
Cell[8054, 262, 823, 27, 135, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8914, 294, 45, 0, 58, "Subsubsection"],
Cell[8962, 296, 200, 4, 74, "Text"],
Cell[CellGroupData[{
Cell[9187, 304, 1089, 35, 75, "Input"],
Cell[10279, 341, 1724, 42, 118, "Output"]
}, Open  ]],
Cell[12018, 386, 57, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[12100, 390, 64, 1, 45, "Input"],
Cell[12167, 393, 1996, 49, 162, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14212, 448, 30, 0, 58, "Subsubsection"],
Cell[14245, 450, 1199, 40, 159, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15481, 495, 56, 0, 58, "Subsubsection"],
Cell[15540, 497, 72, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[15637, 501, 136, 3, 45, "Input"],
Cell[15776, 506, 1755, 44, 75, "Output"]
}, Open  ]],
Cell[17546, 553, 58, 0, 45, "Text"],
Cell[CellGroupData[{
Cell[17629, 557, 71, 1, 45, "Input"],
Cell[17703, 560, 2056, 51, 190, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19808, 617, 61, 0, 58, "Subsubsection"],
Cell[19872, 619, 623, 21, 131, "Text"],
Cell[20498, 642, 1798, 50, 162, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22333, 697, 60, 0, 58, "Subsubsection"],
Cell[22396, 699, 536, 12, 133, "Text"],
Cell[22935, 713, 864, 26, 104, "Input"],
Cell[CellGroupData[{
Cell[23824, 743, 364, 11, 75, "Input"],
Cell[24191, 756, 3894, 102, 583, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28134, 864, 71, 0, 58, "Subsubsection"],
Cell[28208, 866, 252, 8, 50, "Text"],
Cell[28463, 876, 1838, 51, 191, "Input"],
Cell[30304, 929, 807, 21, 169, "Text"],
Cell[31114, 952, 986, 29, 133, "Input"],
Cell[CellGroupData[{
Cell[32125, 985, 365, 11, 75, "Input"],
Cell[32493, 998, 4942, 138, 568, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37484, 1142, 69, 0, 58, "Subsubsection"],
Cell[37556, 1144, 254, 7, 77, "Text"],
Cell[37813, 1153, 579, 17, 104, "Input"],
Cell[38395, 1172, 222, 6, 74, "Text"],
Cell[38620, 1180, 734, 22, 104, "Input"],
Cell[CellGroupData[{
Cell[39379, 1206, 363, 11, 75, "Input"],
Cell[39745, 1219, 3303, 86, 211, "Output"]
}, Open  ]],
Cell[43063, 1308, 141, 3, 74, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43241, 1316, 58, 0, 58, "Subsubsection"],
Cell[43302, 1318, 203, 6, 74, "Text"],
Cell[CellGroupData[{
Cell[43530, 1328, 505, 16, 75, "Input"],
Cell[44038, 1346, 1287, 27, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45374, 1379, 57, 0, 58, "Subsubsection"],
Cell[45434, 1381, 357, 12, 56, "Text"],
Cell[45794, 1395, 253, 8, 45, "Input"],
Cell[46050, 1405, 98, 2, 45, "Text"],
Cell[46151, 1409, 743, 22, 104, "Input"],
Cell[CellGroupData[{
Cell[46919, 1435, 366, 11, 75, "Input"],
Cell[47288, 1448, 3253, 84, 217, "Output"]
}, Open  ]],
Cell[50556, 1535, 95, 2, 45, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50688, 1542, 60, 0, 58, "Subsubsection"],
Cell[50751, 1544, 912, 29, 107, "Text"],
Cell[51666, 1575, 737, 21, 104, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52440, 1601, 59, 0, 58, "Subsubsection"],
Cell[52502, 1603, 426, 12, 45, "Input"],
Cell[CellGroupData[{
Cell[52953, 1619, 162, 4, 45, "Input"],
Cell[53118, 1625, 5189, 135, 232, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58356, 1766, 126, 1, 58, "Subsubsection"],
Cell[58485, 1769, 1047, 28, 79, "Text"],
Cell[59535, 1799, 505, 7, 45, "Text"],
Cell[60043, 1808, 1330, 31, 104, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61410, 1844, 187, 2, 58, "Subsubsection"],
Cell[61600, 1848, 593, 15, 45, "Input"],
Cell[CellGroupData[{
Cell[62218, 1867, 225, 5, 45, "Input"],
Cell[62446, 1874, 10933, 298, 254, "Output"]
}, Open  ]],
Cell[73394, 2175, 201, 3, 104, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73632, 2183, 258, 4, 58, "Subsubsection"],
Cell[73893, 2189, 4342, 138, 140, "Text"],
Cell[78238, 2329, 1317, 30, 104, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79592, 2364, 39, 0, 58, "Subsubsection"],
Cell[79634, 2366, 338, 10, 74, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
